"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2749],{2700:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var i=s(4848),t=s(8453);const r={sidebar_position:2},l="Install Site",o={id:"install-online-judge/install-site",title:"Install Site",description:"Original source:",source:"@site/docs/install-online-judge/install-site.md",sourceDirName:"install-online-judge",slug:"/install-online-judge/install-site",permalink:"/tempdocs/docs/install-online-judge/install-site",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Install SSH",permalink:"/tempdocs/docs/install-online-judge/install-ssh"},next:{title:"Install Judge",permalink:"/tempdocs/docs/install-online-judge/install-judge"}},a={},d=[{value:"Installing the prerequisites",id:"installing-the-prerequisites",level:2},{value:"Creating the database",id:"creating-the-database",level:2},{value:"Creating environments, modules and libraries",id:"creating-environments-modules-and-libraries",level:2},{value:"Compiling assets",id:"compiling-assets",level:2},{value:"Setting up Celery",id:"setting-up-celery",level:2},{value:"Setting up database tables",id:"setting-up-database-tables",level:2},{value:"Running the server",id:"running-the-server",level:2},{value:"Setting up uWSGI",id:"setting-up-uwsgi",level:2},{value:"Setting up supervisord",id:"setting-up-supervisord",level:2},{value:"Setting up nginx",id:"setting-up-nginx",level:2},{value:"Configuration of event server",id:"configuration-of-event-server",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"install-site",children:"Install Site"})}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)("b",{children:"Original source:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.dmoj.ca/#/",children:"DMOJ Documentations"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://vnoi-admin.github.io/vnoj-docs/#/",children:"VNOI Documentations"})}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"installing-the-prerequisites",children:"Installing the prerequisites"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ apt update\r\n$ apt install git gcc g++ make python3-dev python3-pip libxml2-dev\r\n$ apt install libxslt1-dev zlib1g-dev gettext curl redis-server\r\n$ curl -sL https://deb.nodesource.com/setup_18.x | sudo -E bash -\r\n$ apt install nodejs\r\n$ npm install -g sass postcss-cli postcss autoprefixer\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-the-database",children:"Creating the database"}),"\n",(0,i.jsxs)(n.p,{children:["Next, we will set up the database using MariaDB. The TomChienXuOJ is only tested to work with MySQL, and it is unlikely to work with anything else. Please visit ",(0,i.jsx)(n.a,{href:"https://mariadb.org/download/?t=repo-config",children:"the MariaDB site"})," and follow the download instructions."]}),"\n",(0,i.jsx)(n.p,{children:"When asked, you should select the latest MariaDB version."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ apt update\r\n$ apt install mariadb-server libmysqlclient-dev\n"})}),"\n",(0,i.jsx)(n.p,{children:"The next step is to set up the database itself. You should execute the commands listed below to create the necessary database and user."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ sudo mariadb\r\nMariaDB> CREATE DATABASE dmoj DEFAULT CHARACTER SET utf8mb4 DEFAULT COLLATE utf8mb4_general_ci;\r\nMariaDB> GRANT ALL PRIVILEGES ON dmoj.* TO 'dmoj'@'localhost' IDENTIFIED BY '<mariadb user password>';\r\nMariaDB> exit\r\n\r\n# Add time zone data to the database. A few pages require this.\r\n$ mariadb-tzinfo-to-sql /usr/share/zoneinfo | sudo mariadb -u root mysql\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-environments-modules-and-libraries",children:"Creating environments, modules and libraries"}),"\n",(0,i.jsxs)(n.p,{children:["Now that you are done, you can start installing the site. First, create a virtual environment and activate it. Here, we'll create a virtual environment named ",(0,i.jsx)(n.code,{children:"vnojsite"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal"',children:"$ python3 -m venv vnojsite\r\n$ . vnojsite/bin/activate\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You should see ",(0,i.jsx)(n.code,{children:"(vnojsite)"})," prepended to your shell. Henceforth, ",(0,i.jsx)(n.code,{children:"(vnojsite)"})," commands assume you are in the code directory, with the virtual environment active."]}),"\n",(0,i.jsx)(n.admonition,{title:"About virtual environments",type:"info",children:(0,i.jsxs)(n.p,{children:["The virtual environment will help keep the modules needed separate from the system package manager, and save you many headaches when updating. Read more about virtual environments ",(0,i.jsx)(n.a,{href:"https://docs.python.org/3/tutorial/venv.html",children:"here"}),"."]})}),"\n",(0,i.jsx)(n.p,{children:"Now, fetch the site source code:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ git clone --recursive https://github.com/VNOI-Admin/OJ.git site\r\n(vnojsite) $ cd site\n"})}),"\n",(0,i.jsx)(n.p,{children:"Install Python dependencies into the virtual environment."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ pip3 install -r requirements.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"Install Node.js packages:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ npm install\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You will now need to configure ",(0,i.jsx)(n.code,{children:"dmoj/local_settings.py"}),". You should make a copy of ",(0,i.jsx)(n.a,{href:"https://github.com/VNOI-Admin/vnoj-docs/blob/master/sample_files/local_settings.py",children:"this sample settings file"})," and read through it, making changes as necessary. Most importantly, you will want to update MariaDB credentials."]}),"\n",(0,i.jsx)(n.admonition,{title:"About debug mode (In installation process)",type:"info",children:(0,i.jsx)(n.p,{children:"Leave debug mode on for now, we'll disable it later after we've verified that the site works."})}),"\n",(0,i.jsx)(n.admonition,{title:"Site configurations in setting files",type:"info",children:(0,i.jsxs)(n.p,{children:["Generally, it's recommended that you add your settings in ",(0,i.jsx)(n.code,{children:"dmoj/local_settings.py"})," rather than modifying ",(0,i.jsx)(n.code,{children:"dmoj/settings.py"})," directly. ",(0,i.jsx)(n.code,{children:"settings.py"})," will automatically read ",(0,i.jsx)(n.code,{children:"local_settings.py"})," and load it, so write your configuration there."]})}),"\n",(0,i.jsx)(n.h2,{id:"compiling-assets",children:"Compiling assets"}),"\n",(0,i.jsxs)(n.p,{children:["TomChienXuOJ uses ",(0,i.jsx)(n.code,{children:"sass"})," and ",(0,i.jsx)(n.code,{children:"autoprefixer"})," to generate the site stylesheets. TomChienXuOJ comes with a ",(0,i.jsx)(n.code,{children:"make_style.sh"})," script that may be run to compile and optimize the stylesheets."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ bash make_style.sh\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now, collect static files into ",(0,i.jsx)(n.code,{children:"STATIC_ROOT"})," as specified in ",(0,i.jsx)(n.code,{children:"dmoj/local_settings.py"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py collectstatic\n"})}),"\n",(0,i.jsx)(n.p,{children:"You will also need to generate internationalization files."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py compilemessages\r\n(vnojsite) $ python3 manage.py compilejsi18n\n"})}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-celery",children:"Setting up Celery"}),"\n",(0,i.jsx)(n.p,{children:"The TomChienXuOJ uses Celery workers to perform most of its heavy lifting, such as batch rescoring submissions. We will use Redis as its broker, though note that other brokers that Celery supports will work as well."}),"\n",(0,i.jsx)(n.p,{children:"Start up the Redis server, which is needed by the Celery workers."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ service redis-server start\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Configure ",(0,i.jsx)(n.code,{children:"local_settings.py"})," by uncommenting ",(0,i.jsx)(n.code,{children:"CELERY_BROKER_URL"})," and ",(0,i.jsx)(n.code,{children:"CELERY_RESULT_BACKEND"}),". By default, Redis listens on localhost port ",(0,i.jsx)(n.code,{children:"6379"}),", which is reflected in ",(0,i.jsx)(n.code,{children:"local_settings.py"}),". You will need to update the addresses if you changed Redis' settings."]}),"\n",(0,i.jsx)(n.p,{children:"We will test that Celery works soon."}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-database-tables",children:"Setting up database tables"}),"\n",(0,i.jsx)(n.p,{children:"We must generate the schema for the database, since it is currently empty."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py migrate\n"})}),"\n",(0,i.jsx)(n.p,{children:"Next, load some initial data so that your install is not entirely blank."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py loaddata navbar\r\n(vnojsite) $ python3 manage.py loaddata language_small\r\n(vnojsite) $ python3 manage.py loaddata demo\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Warning",type:"danger",children:(0,i.jsxs)(n.p,{children:["Keep in mind that the ",(0,i.jsx)(n.code,{children:"demo"})," fixture creates a superuser account with a ",(0,i.jsx)(n.strong,{children:"username"})," and ",(0,i.jsx)(n.strong,{children:"password"})," of ",(0,i.jsx)(n.code,{children:"admin"}),". If your site is exposed to others, you should change the user's password or remove the user entirely."]})}),"\n",(0,i.jsx)(n.p,{children:"You should create an admin account with which to log in initially."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py createsuperuser\n"})}),"\n",(0,i.jsx)(n.h2,{id:"running-the-server",children:"Running the server"}),"\n",(0,i.jsx)(n.p,{children:"Now, you should verify that everything is going according to plan."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py check\n"})}),"\n",(0,i.jsx)(n.p,{children:"At this point, you should attempt to run the server, and see if it all works."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py runserver 0.0.0.0:8000\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You should ",(0,i.jsx)("kbd",{children:"Ctrl"}),"+",(0,i.jsx)("kbd",{children:"C"})," to exit after verifying."]}),"\n",(0,i.jsxs)(n.admonition,{type:"danger",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["Do not use ",(0,i.jsx)(n.code,{children:"runserver"})," in production!"]}),(0,i.jsxs)(n.p,{children:["We will set up a proper web-server using ",(0,i.jsx)(n.code,{children:"nginx"})," and ",(0,i.jsx)(n.code,{children:"uWSGI"})," soon."]})]}),"\n",(0,i.jsxs)(n.p,{children:["You should also test to see if ",(0,i.jsx)(n.code,{children:"bridged"})," runs."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ python3 manage.py runbridged\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If there are no errors after about 10 seconds, it probably works. You should ",(0,i.jsx)("kbd",{children:"Ctrl"}),"+",(0,i.jsx)("kbd",{children:"C"})," to exit."]}),"\n",(0,i.jsx)(n.p,{children:"Next, test that the Celery workers run."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ celery -A dmoj_celery worker\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You can ",(0,i.jsx)("kbd",{children:"Ctrl"}),"+",(0,i.jsx)("kbd",{children:"C"})," to exit."]}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-uwsgi",children:"Setting up uWSGI"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"runserver"})," is insecure and not meant for production workloads, and should not be used beyond testing. In the rest of this guide, we will be installing ",(0,i.jsx)(n.code,{children:"uwsgi"})," and ",(0,i.jsx)(n.code,{children:"nginx"})," to serve the site, using ",(0,i.jsx)(n.code,{children:"supervisord"})," to keep ",(0,i.jsx)(n.code,{children:"site"})," and ",(0,i.jsx)(n.code,{children:"bridged"})," running. It's likely other configurations may work, but they are unsupported."]}),"\n",(0,i.jsxs)(n.p,{children:["First, copy our ",(0,i.jsx)(n.code,{children:"uwsgi.ini"})," ",(0,i.jsx)(n.a,{href:"https://github.com/VNOI-Admin/vnoj-docs/blob/master/sample_files/uwsgi.ini",children:"(link)"}),". You should change the paths to reflect your install."]}),"\n",(0,i.jsxs)(n.p,{children:["You need to install ",(0,i.jsx)(n.code,{children:"uwsgi"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ pip3 install uwsgi\n"})}),"\n",(0,i.jsx)(n.p,{children:"To test, run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ uwsgi --ini uwsgi.ini\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If it says workers are spawned, it probably works. You ",(0,i.jsx)("kbd",{children:"Ctrl"}),"+",(0,i.jsx)("kbd",{children:"C"})," to exit."]}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-supervisord",children:"Setting up supervisord"}),"\n",(0,i.jsxs)(n.p,{children:["You should now install ",(0,i.jsx)(n.code,{children:"supervisord"})," and configure it."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ apt install supervisor\n"})}),"\n",(0,i.jsx)(n.p,{children:"Copy our:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"site.conf"})," ",(0,i.jsx)(n.a,{href:"https://github.com/VNOI-Admin/vnoj-docs/blob/master/sample_files/site.conf",children:"(link)"})," to ",(0,i.jsx)(n.code,{children:"/etc/supervisor/conf.d/site.conf"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bridged.conf"})," ",(0,i.jsx)(n.a,{href:"https://github.com/VNOI-Admin/vnoj-docs/blob/master/sample_files/bridged.conf",children:"(link)"})," to ",(0,i.jsx)(n.code,{children:"/etc/supervisor/conf.d/bridged.conf"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"celery.conf"})," ",(0,i.jsx)(n.a,{href:"https://github.com/VNOI-Admin/vnoj-docs/blob/master/sample_files/bridged.conf",children:"(link)"})," to ",(0,i.jsx)(n.code,{children:"/etc/supervisor/conf.d/celery.conf"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"and fill in the fields."}),"\n",(0,i.jsx)(n.p,{children:"Next, reload supervisord and check that the site, bridged, and celery have started."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ supervisorctl update\r\n$ supervisorctl status\n"})}),"\n",(0,i.jsx)(n.p,{children:"If all three processes are running, everything is good! Otherwise, peek at the logs and see what's wrong."}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-nginx",children:"Setting up nginx"}),"\n",(0,i.jsxs)(n.p,{children:["Now, it's time to set up ",(0,i.jsx)(n.code,{children:"nginx"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ apt install nginx\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You should copy the sample ",(0,i.jsx)(n.code,{children:"nginx.conf"})," ",(0,i.jsx)(n.a,{href:"https://github.com/VNOI-Admin/vnoj-docs/blob/master/sample_files/nginx.conf",children:"(link)"}),", edit it and place it in wherever it is supposed to be for your nginx install."]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["Where to locate ",(0,i.jsx)(n.code,{children:"nginx.conf"})," file?"]}),(0,i.jsxs)(n.p,{children:["Typically, ",(0,i.jsx)(n.code,{children:"nginx"})," site files are located in ",(0,i.jsx)(n.code,{children:"/etc/nginx/conf.d"}),". Some installations might place it at ",(0,i.jsx)(n.code,{children:"/etc/nginx/sites-available"})," and require a symlink in ",(0,i.jsx)(n.code,{children:"/etc/nginx/sites-enabled"}),"."]})]}),"\n",(0,i.jsx)(n.p,{children:"Next, check if there are any issues with your nginx setup."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ nginx -t\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If not, reload the ",(0,i.jsx)(n.code,{children:"nginx"})," configuration."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ service nginx reload\n"})}),"\n",(0,i.jsx)(n.p,{children:"You should be good to go. Visit the site at where you set it up to verify."}),"\n",(0,i.jsxs)(n.p,{children:["If it does not work, check ",(0,i.jsx)(n.code,{children:"nginx"})," logs and ",(0,i.jsx)(n.code,{children:"uwsgi"})," log ",(0,i.jsx)(n.code,{children:"stdout"}),"/",(0,i.jsx)(n.code,{children:"stderr"})," for details."]}),"\n",(0,i.jsx)(n.admonition,{title:"WARNING",type:"danger",children:(0,i.jsxs)(n.p,{children:["Now that your site is installed, remember to set ",(0,i.jsx)(n.code,{children:"DEBUG"})," to ",(0,i.jsx)(n.code,{children:"False"})," in ",(0,i.jsx)(n.code,{children:"dmoj/local_settings.py"}),". Leaving it ",(0,i.jsx)(n.code,{children:"True"})," is a security risk."]})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-of-event-server",children:"Configuration of event server"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"config.js"})," inside directory websocket with the following content:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="config.js"',children:"const config = {\r\n  get_host: '127.0.0.1',\r\n  get_port: 15100,\r\n  post_host: '127.0.0.1',\r\n  post_port: 15101,\r\n  http_host: '127.0.0.1',\r\n  http_port: 15102,\r\n  long_poll_timeout: 29000\r\n};\r\n\r\nexport default config;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This assumes you use ",(0,i.jsx)(n.code,{children:"nginx"}),", or there be dragons. You may need to shuffle ports if they are already used."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"get_port"})," should be the same as the port for ",(0,i.jsx)(n.code,{children:"/event/"})," in ",(0,i.jsx)(n.code,{children:"nginx.conf"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"http_port"})," should be the same as the port for ",(0,i.jsx)(n.code,{children:"/channels/"})," in ",(0,i.jsx)(n.code,{children:"nginx.conf"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"post_port"})," should be the same as the port in ",(0,i.jsx)(n.code,{children:"EVENT_DAEMON_POST"})," in ",(0,i.jsx)(n.code,{children:"dmoj/local_settings.py"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:[(0,i.jsx)(n.code,{children:"EVENT_DEAMON_*"})," configurations in setting files"]}),(0,i.jsxs)(n.p,{children:["You need to configure ",(0,i.jsx)(n.code,{children:"EVENT_DAEMON_GET"})," and ",(0,i.jsx)(n.code,{children:"EVENT_DAEMON_POLL"}),". You need to uncomment the relevant section in the nginx configuration."]})]}),"\n",(0,i.jsx)(n.p,{children:"Need to install the dependencies."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Environment activated)"',children:"(vnojsite) $ pip3 install websocket-client\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now copy ",(0,i.jsx)(n.code,{children:"wsevent.conf"})," ",(0,i.jsx)(n.a,{href:"https://github.com/VNOI-Admin/vnoj-docs/blob/master/sample_files/wsevent.conf",children:"(link)"})," to ",(0,i.jsx)(n.code,{children:"/etc/supervisor/conf.d/wsevent.conf"}),", changing paths, and then update ",(0,i.jsx)(n.code,{children:"supervisor"})," and ",(0,i.jsx)(n.code,{children:"nginx"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Terminal (Root permissions)"',children:"$ supervisorctl update\r\n$ supervisorctl restart bridged\r\n$ supervisorctl restart site\r\n$ service nginx restart\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);